<!DOCTYPE html>
<html>
  <head>
    <!-- Required meta tags -->
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <!-- Bootstrap CSS -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3"
      crossorigin="anonymous"
    />
    <title>웨비</title>
    <script>
      const todayCheck = () => {
        let now = new Date();
        let date = now.getDate(); // 현재 날짜 및 시간
        let dayTD = document.getElementById(date);

        if (dayTD.getAttribute("class") == "table-success") {
          let button = document.getElementById("attendBTN");
          button.disabled = true;
        }
      };

      window.addEventListener("DOMContentLoaded", todayCheck);
    </script>
  </head>
  <body>
    <div class="container-fluid">
      <div class="row">
        <div class="col-3"></div>
        <div class="col-6">
          <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
            <div class="container-fluid">
              <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav">
                  <li class="nav-item">
                    <a class="nav-link active" aria-current="page" href="/main"
                      >HOME</a
                    >
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="/conversation">웨비와 대화</a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="/showoff">웨비 자랑</a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="/attend">출석체크</a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="/market">포인트 상점</a>
                  </li>
                </ul>
              </div>
            </div>
          </nav>
        </div>
        <div class="col-3"></div>
      </div>
      <div class="row">
        <div class="col-3"></div>
        <div class="col-6">
          <table class="table">
            <tbody>
              <tr>
                <td class="" id="1">1</td>
                <td class="" id="2">2</td>
                <td class="" id="3">3</td>
                <td class="" id="4">4</td>
                <td class="" id="5">5</td>
                <td class="" id="6">6</td>
                <td class="" id="7">7</td>
              </tr>
              <tr>
                <td class="" id="8">8</td>
                <td class="" id="9">9</td>
                <td class="" id="10">10</td>
                <td class="" id="11">11</td>
                <td class="" id="12">12</td>
                <td class="" id="13">13</td>
                <td class="" id="14">14</td>
              </tr>
              <tr>
                <td class="" id="15">15</td>
                <td class="" id="16">16</td>
                <td class="" id="17">17</td>
                <td class="" id="18">18</td>
                <td class="" id="19">19</td>
                <td class="" id="20">20</td>
                <td class="" id="21">21</td>
              </tr>
              <tr>
                <td class="" id="22">22</td>
                <td class="" id="23">23</td>
                <td class="" id="24">24</td>
                <td class="" id="25">25</td>
                <td class="" id="26">26</td>
                <td class="" id="27">27</td>
                <td class="" id="28">28</td>
              </tr>
              <tr>
                <td class="" id="29">29</td>
                <td class="" id="30">30</td>
                <td class="" id="31">31</td>
              </tr>
            </tbody>
          </table>
          <form id="form" method="post">
            <button class="btn btn-primary" id="attendBTN" type="submit">
              출석!
            </button>
          </form>
        </div>
        <div class="col-3"></div>
      </div>
    </div>

    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p"
      crossorigin="anonymous"
    ></script>
    <script>
      let content = null;
      let xmlhttp = new XMLHttpRequest();
      xmlhttp.open("GET", "file/attendance.txt", false);
      xmlhttp.send();
      if (xmlhttp.status == 200) {
        content = xmlhttp.responseText;
      }

      attendArray = content.toString().split("\n");
      attendArray[0] = attendArray[0].split(",");
      for (let i = 0; i < 31; i++) {
        if (attendArray[0][i] == 1) {
          let id = i + 1;
          let DateTd = document.getElementById(id);
          DateTd.setAttribute("class", "table-success");
        }
      }

      document.getElementById("form").addEventListener("submit", async (e) => {
        let now = new Date();
        let date = now.getDate(); // 현재 날짜 및 시간
        let dayTD = document.getElementById(date);
        dayTD.className = "table-success";
        alert("출석 체크 완료\n 포인트 +10p");
      });
    </script>
  </body>
</html>
